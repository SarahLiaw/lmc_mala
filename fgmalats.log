nohup: ignoring input
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: sliaw (sliaw-california-institute-of-technology-caltech) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.9
wandb: Run data is saved locally in /home/sarahl/LMCTS3/wandb/run-20250507_202100-endsfjed
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run adult_FGMALATS_seed2915_0507_2021
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sliaw-california-institute-of-technology-caltech/ContextualBandit-ICML
wandb: üöÄ View run at https://wandb.ai/sliaw-california-institute-of-technology-caltech/ContextualBandit-ICML/runs/endsfjed
Random seed: 2915
Start running...
  0%|          | 0/10000 [00:00<?, ?it/s]/home/sarahl/miniconda3/envs/plmc-env/lib/python3.9/site-packages/torch/autograd/profiler.py:266: UserWarning: CUDA is not available, disabling CUDA profiling
  warn("CUDA is not available, disabling CUDA profiling")
ERROR:2025-05-07 20:21:09 46003:46003 DeviceProperties.cpp:47] gpuGetDeviceCount failed with code 35
Accumulated regret: 0:   0%|          | 0/10000 [00:00<?, ?it/s]Accumulated regret: 0:   0%|          | 1/10000 [00:00<28:21,  5.88it/s]Accumulated regret: 0:   0%|          | 1/10000 [00:00<2:35:31,  1.07it/s]
-----------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                         Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                Arm selection         0.78%     726.965us        99.85%      92.727ms      92.727ms             1  
                 aten::argmax        67.78%      62.948ms        67.80%      62.964ms      62.964ms             1  
             aten::leaky_relu        30.81%      28.610ms        30.81%      28.610ms      28.610ms             1  
                 aten::linear         0.05%      42.890us         0.45%     417.928us     208.964us             2  
                  aten::addmm         0.20%     187.506us         0.23%     216.622us     216.622us             1  
                      aten::t         0.05%      47.733us         0.10%      92.825us      46.413us             2  
                 Update model         0.07%      69.415us         0.07%      69.415us      69.415us             1  
                 aten::matmul         0.01%      12.008us         0.07%      65.591us      65.591us             1  
                     aten::mm         0.06%      52.574us         0.06%      53.583us      53.583us             1  
              aten::transpose         0.03%      31.428us         0.05%      45.092us      22.546us             2  
                     aten::ne         0.04%      34.584us         0.04%      34.584us      34.584us             1  
                 aten::select         0.03%      28.199us         0.03%      31.389us      31.389us             1  
             aten::as_strided         0.02%      19.658us         0.02%      19.658us       3.932us             5  
                  aten::copy_         0.02%      19.156us         0.02%      19.156us      19.156us             1  
                aten::reshape         0.01%       9.521us         0.02%      14.076us      14.076us             1  
                   aten::item         0.01%       6.483us         0.01%      11.173us       5.587us             2  
                 aten::expand         0.01%       7.484us         0.01%       8.555us       8.555us             1  
             aten::is_nonzero         0.00%       2.091us         0.01%       5.082us       5.082us             1  
    aten::_local_scalar_dense         0.01%       4.690us         0.01%       4.690us       2.345us             2  
                   aten::view         0.00%       4.555us         0.00%       4.555us       4.555us             1  
-----------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 92.868ms

Traceback (most recent call last):
  File "/home/sarahl/LMCTS3/run_classifier.py", line 136, in <module>
    run(config, args)
  File "/home/sarahl/LMCTS3/run_classifier.py", line 94, in run
    agent.update_model(num_iter=min(50, config['num_iter']))
  File "/home/sarahl/LMCTS3/algo/malats.py", line 136, in update_model
    loss_cur = self._forward_backward()
  File "/home/sarahl/LMCTS3/algo/fg_malats.py", line 60, in _forward_backward
    loss = self.criterion(pred, self._rew) + self._fg_bonus(pred)
  File "/home/sarahl/LMCTS3/algo/fg_malats.py", line 47, in _fg_bonus
    g_star = pred.max(dim=1).values                            # (N,)
IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33madult_FGMALATS_seed2915_0507_2021[0m at: [34mhttps://wandb.ai/sliaw-california-institute-of-technology-caltech/ContextualBandit-ICML/runs/endsfjed[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250507_202100-endsfjed/logs[0m
